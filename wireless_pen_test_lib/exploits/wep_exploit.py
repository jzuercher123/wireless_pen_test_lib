from wireless_pen_test_lib.core import CoreFramework
from .base_exploit import BaseExploit


class WEPExploit(BaseExploit):
    """
    An exploit to crack WEP keys.
    """
    def __init__(self):
        super().__init__()
        self.logger = self.set_logger("WEPExploit")


    def run(self, core_framework: CoreFramework, target_info=None):
        """
        Run the WEP exploit.

        Args:
            core_framework (CoreFramework): The core framework instance.
            target_info (dict): Information about the target network.

        Returns:
            dict: Exploit results.
        """
        self.logger.info("Running WEP exploit...")
        return {
            "BSSID": target_info.get("BSSID"),
            "Description": "WEP key cracked!",
            "Action": "Connect to the network using the cracked key."
       }


if __name__=="__main__":
    core_framework = CoreFramework()
    exploit = WEPExploit()
    exploit.run(core_framework, target_info={"BSSID": "00:11:22:33:44:55"})